<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background-color: #f5f5f5; padding: 20px; }
        .email-container { max-width: 600px; margin: 0 auto; background-color: #ffffff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); }
        .header { background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white; padding: 40px 30px; text-align: center; }
        .content { padding: 40px 30px; }
        .warning-box { background-color: #fff3cd; border-left: 4px solid #ffc107; border-radius: 4px; padding: 20px; margin: 30px 0; }
        .retry-button { display: inline-block; background: linear-gradient(135deg, #ff9800 0%, #f57c00 100%); color: white; text-decoration: none; padding: 15px 40px; border-radius: 8px; font-weight: 600; margin-top: 20px; }
        .footer { background-color: #f8f9fa; padding: 30px; text-align: center; color: #666; font-size: 14px; }
    </style>
</head>
<body>
    <div class="email-container">
        <div class="header">
            <h1>⚠️ Payment Failed</h1>
            <p>We couldn't process your payment</p>
        </div>

        <div class="content">
            <p style="font-size: 16px; color: #333; margin-bottom: 20px;">
                Hi {% if order.customer %}{{ order.customer.user.first_name }}{% else %}there{% endif %},
            </p>
            
            <p style="font-size: 16px; color: #555; margin-bottom: 30px;">
                Unfortunately, we were unable to process the payment for your order <strong>{{ order.order_number }}</strong>.
            </p>

            <div class="warning-box">
                <p style="margin: 0; color: #856404; font-weight: 600;">Common reasons for payment failure:</p>
                <ul style="margin: 10px 0 0 20px; color: #856404;">
                    <li>Insufficient funds</li>
                    <li>Incorrect card details</li>
                    <li>Card expired</li>
                    <li>Bank security restrictions</li>
                </ul>
            </div>

            <div style="margin: 30px 0; padding: 20px; background-color: #f8f9fa; border-radius: 8px;">
                <h3 style="font-size: 16px; color: #333; margin-bottom: 15px;">Order Details</h3>
                <p style="color: #666; line-height: 1.8;">
                    <strong>Order Number:</strong> {{ order.order_number }}<br>
                    <strong>Order Total:</strong> {{ order.currency }} {{ order.total }}<br>
                    <strong>Payment Method:</strong> {{ order.get_payment_method_display }}
                </p>
            </div>

            <p style="font-size: 16px; color: #555; text-align: center; margin-bottom: 20px;">
                Don't worry! Your order is still reserved. Please try again with a different payment method.
            </p>

            <center>
                <a href="{{ site_url }}/orders/{{ order.order_number }}/retry-payment" class="retry-button">
                    Retry Payment
                </a>
            </center>

            <div style="margin-top: 40px; padding: 20px; background-color: #e3f2fd; border-radius: 8px;">
                <p style="margin: 0; color: #1976d2; font-weight: 600;">Need Help?</p>
                <p style="margin: 10px 0 0 0; color: #555;">
                    If you continue to experience issues, please contact us at 
                    <a href="mailto:{{ support_email }}" style="color: #1976d2;">{{ support_email }}</a>
                </p>
            </div>
        </div>

        <div class="footer">
            <p>{{ site_name }} | Making your audio dreams come true</p>
        </div>
    </div>
</body>
</html>